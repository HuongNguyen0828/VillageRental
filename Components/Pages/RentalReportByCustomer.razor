@page "/reportSaleByCustomer"

@using VillageRental.Data
@using VillageRental.Services
@inject NavigationManager navigationMangager

<h3>Rental Report</h3>

<div style="text-align: center">
	<div> <strong>Total</strong>: @rentalList.Count()</div>
	<div style="color: red; font-weight: bold"> Revenue: $@total</div>
	
</div>


@if (rentalList == null)
{
	<p><em>Loading...</em></p>
}
else
{
	<br>
	<br />
	<table class="table table-striped">
		<thead>
			<tr style="text-align: center">
				<th>Id</th>
				<th>First Name</th>
				<th>Last Name</th>
				<th>Date</th>
				<th>Equipment</th>
				<th> Quantity</th>
				<th>Total Cost</th>
			</tr>
		</thead>
		<tbody>
			@foreach (var rental in rentalList)
			{
				<tr style="text-align: center">
					<td>@rental.ID</td>
					<td>@rental.FirstName</td>
					<td>@rental.LastName</td>
					<td>@rental.RentalDate</td>
					<td>@rental.EquipmentName</td>
					<td>@rental.Quantity</td>
					<td>$@rental.TotalCost</td>
				</tr>
			}
		</tbody>
	</table>
}

<NavLink class="nav-link" href="/makeReport">
	<span class="bi bi-plus-square-fill-nav-menu" aria-hidden="true"></span> Back to Report
</NavLink>


@code {
	public List<RentAEquipmentFullInfo> rentalList = new();
	DatabaseService databaseService = new();
	decimal total = 0;

	//Error was here
	protected override async Task OnInitializedAsync()
	{
		rentalList = await databaseService.GetAllRental();
		foreach (RentAEquipmentFullInfo rental in rentalList)
		{
			total += rental.TotalCost;
		}
	}


}

